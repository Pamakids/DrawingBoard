<?xml version="1.0" encoding="utf-8"?>
<s:Group xmlns:fx="http://ns.adobe.com/mxml/2009"
		 xmlns:s="library://ns.adobe.com/flex/spark" width="310" height="322"
		 xmlns:local="*">
	<fx:Script>
		<![CDATA[

			import assets.player.PlayerAssets;

			private var rec:RecordAudio;

			protected function close(event:MouseEvent):void
			{
				dispatchEvent(new Event("close"));
			}

			private function rotate():void
			{
				circle.rotation+=6;
			}

			protected function pressDown(event:MouseEvent):void
			{
				pressBtn.source=PlayerAssets.btn_pressToRecord_B;
				stage.addEventListener(MouseEvent.MOUSE_UP, onRelease);

				addEventListener(Event.ENTER_FRAME, onEnterFrame);

				rec=RecordAudio.instance;
				rec.startRecord("test");
			}

			private var recUrl:String;

			protected function onRelease(event:MouseEvent):void
			{
				pressBtn.source=PlayerAssets.btn_pressToRecord;
				stage.removeEventListener(MouseEvent.MOUSE_UP, onRelease);
				removeEventListener(Event.ENTER_FRAME, onEnterFrame);

				pressBtn.mouseEnabled=false;
				rec.stopRecord(recSaved);

//					rec.toAmr(function(u2:String):void {
//						trace(u2)


			}

			private function recSaved(u:String):void
			{
				recUrl=u;
				pressBtn.mouseEnabled=true;
				pressBtn.visible=false;
			}

			protected function reRecord(event:MouseEvent):void
			{
				recUrl="";
				pressBtn.visible=true;
			}

			protected function playRecord(event:MouseEvent):void
			{
				rec.playAmr(recUrl);
			}

			protected function onEnterFrame(event:Event):void
			{
				rotate();
			}

		]]>
	</fx:Script>
	<s:Image source="{PlayerAssets.recordBg}"/>
	<s:Image source="@Embed('assets/global/close.png')" click="close(event)"
			 top="17" left="255"/>
	<s:Group x="155" y="152" id="circle">
		<s:Image source="@Embed('assets/player/btn/recordCircle.png')" x="-42"
				 y="-42"/>
	</s:Group>
	<s:Image left="138" top="128"
			 source="@Embed('assets/player/btn/recordMic.png')"/>

	<s:Image id="pressBtn" source="{PlayerAssets.btn_pressToRecord}" left="31"
			 top="242" mouseDown="pressDown(event)"/>

	<s:HGroup visible="{!pressBtn.visible}" left="26" top="238" gap="7">
		<s:Image source="{PlayerAssets.btn_reRecord}" click="reRecord(event)"/>
		<s:Image source="{PlayerAssets.btn_playRecord}"
				 click="playRecord(event)"/>
	</s:HGroup>
</s:Group>
